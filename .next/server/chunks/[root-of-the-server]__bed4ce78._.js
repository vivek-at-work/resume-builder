module.exports=[48527,(e,t,r)=>{t.exports=e.x("pdf-parse-08f4573089f02674",()=>require("pdf-parse-08f4573089f02674"))},92026,e=>{"use strict";var t=e.i(47909),r=e.i(74017),n=e.i(96250),a=e.i(59756),i=e.i(61916),o=e.i(74677),s=e.i(69741),l=e.i(16795),c=e.i(87718),u=e.i(95169),d=e.i(47587),p=e.i(66012),h=e.i(70101),f=e.i(26937),m=e.i(10372),g=e.i(93695);e.i(52474);var w=e.i(220),E=e.i(7218),R=e.i(89171);function x(e){let t=e.match(/(\+?\d{1,3}[-.\s]?)?\(?\d{3}\)?[-.\s]?\d{3}[-.\s]?\d{4}/g);return t?.[0]||""}async function v(t){try{let{PDFParse:r}=e.r(48527),n="";try{let e=new r({data:t}),a=await e.getText();n=a?.text||""}catch(e){console.error("PDF text extraction failed, will use OpenAI only:",e)}let a=new(await e.A(82694)).default({apiKey:process.env.OPENAI_API_KEY});if(!process.env.OPENAI_API_KEY){if(n)return y(n);throw Error("OPENAI_API_KEY is not configured. Please set it in your environment variables.")}if(!n||0===n.trim().length)throw Error("Could not extract text from PDF. The PDF might be image-based, password-protected, or corrupted.");let i=`Parse the following resume text and extract structured information. Return a JSON object with this exact structure:

{
  "personalInfo": {
    "fullName": "string",
    "email": "string",
    "phone": "string",
    "location": "string",
    "linkedIn": "string (URL or empty)",
    "portfolio": "string (URL or empty)"
  },
  "professionalSummary": "string",
  "workExperience": [
    {
      "company": "string",
      "position": "string",
      "startDate": "string (YYYY-MM format)",
      "endDate": "string (YYYY-MM format or empty)",
      "current": boolean,
      "description": "string"
    }
  ],
  "education": [
    {
      "institution": "string",
      "degree": "string",
      "field": "string",
      "graduationDate": "string (YYYY-MM format)"
    }
  ],
  "skills": {
    "technical": "string (comma-separated)",
    "soft": "string (comma-separated or empty)"
  }
}

IMPORTANT FORMATTING INSTRUCTIONS:
- For work experience descriptions: Convert long paragraphs into bullet points. Format each bullet point on a new line starting with "- " or "• ". Break down responsibilities, achievements, and accomplishments into separate bullet points.
- For professional summary: If the summary is a long paragraph, break it into 2-3 concise bullet points when possible, each on a new line starting with "- " or "• ".
- Preserve the original meaning and content, but organize it as bullet lists instead of long paragraphs.
- Each bullet point should be a complete, meaningful statement.

Resume text:
${n}

Return ONLY valid JSON, no additional text or markdown formatting.`,o=await a.chat.completions.create({model:"gpt-4o",messages:[{role:"user",content:i}],response_format:{type:"json_object"},max_tokens:4e3}),s=o.choices[0]?.message?.content||"{}",l=JSON.parse(s);return{personalInfo:l.personalInfo||{fullName:"",email:"",phone:"",location:"",linkedIn:"",portfolio:""},professionalSummary:l.professionalSummary||"",workExperience:l.workExperience?.length>0?l.workExperience:[{company:"",position:"",startDate:"",endDate:"",current:!1,description:""}],education:l.education?.length>0?l.education:[{institution:"",degree:"",field:"",graduationDate:""}],skills:{technical:l.skills?.technical||"",soft:l.skills?.soft||""}}}catch(n){console.error("Error parsing PDF with OpenAI:",n);let r=n instanceof Error?n.message:String(n);console.error("PDF Parse Error Details:",r);try{let{PDFParse:r}=e.r(48527),n=new r({data:t}),a=await n.getText(),i=a?.text||"";if(i&&i.trim().length>0)return console.log("Falling back to regex parsing"),y(i)}catch(e){console.error("Fallback parsing also failed:",e)}if(r.includes("OPENAI_API_KEY"))throw Error("OpenAI API key is not configured. Please set OPENAI_API_KEY in your environment variables.");if(r.includes("empty")||r.includes("extract text"))throw Error("Could not extract text from PDF. The PDF might be image-based, password-protected, or corrupted.");if(r.includes("Invalid PDF"))throw Error("Invalid PDF file format. Please ensure the file is a valid PDF.");else if(r.includes("rate_limit")||r.includes("quota"))throw Error("OpenAI API rate limit exceeded. Please try again later.");else if(r.includes("JSON"))throw Error("Failed to parse OpenAI response. Please try again.");else throw Error(`Failed to parse PDF: ${r}`)}}function y(e){let t,r,n,a,i={fullName:function(e){let t=e.split("\n").filter(e=>e.trim().length>0);for(let e=0;e<Math.min(5,t.length);e++){let r=t[e].trim();if(r.includes("@")||x(r)||r.startsWith("http")||r.toLowerCase().includes("resume")||r.toLowerCase().includes("cv"))continue;let n=r.split(/\s+/);if(n.length>=2&&n.length<=4)return r}return""}(e),email:(t=e.match(/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/g),t?.[0]||""),phone:x(e),location:function(e){for(let t of[/([A-Z][a-z]+(?:\s+[A-Z][a-z]+)*),\s*([A-Z]{2})/g,/([A-Z][a-z]+(?:\s+[A-Z][a-z]+)*),\s*([A-Z][a-z]+)/g]){let r=e.match(t);if(r&&r.length>0)return r[0]}return""}(e),linkedIn:(r=e.match(/(?:https?:\/\/)?(?:www\.)?linkedin\.com\/in\/[\w-]+/gi),r?.[0]||""),portfolio:(n=e.match(/(?:https?:\/\/)?(?:www\.)?[a-zA-Z0-9-]+\.[a-zA-Z]{2,}(?:\/[^\s]*)?/gi),a=n?.filter(e=>!e.includes("linkedin.com")&&!e.includes("@")&&!e.includes("gmail.com")&&!e.includes("yahoo.com")&&!e.includes("outlook.com")),a?.[0]||"")},o=function(e){let t=e.split("\n"),r=["summary","objective","profile","about"];for(let e=0;e<Math.min(20,t.length);e++){let n=t[e].trim().toLowerCase();if(r.some(e=>n.includes(e))&&n.length<50){let r="";for(let n=e+1;n<Math.min(e+5,t.length);n++){let e=t[n].trim();e.length>10&&(r+=(r?" ":"")+e)}return r}}return""}(e),s=function(e){let t=[],r=e.split("\n"),n=["experience","employment","work history","professional experience","career"],a=!1,i=null;for(let e=0;e<r.length;e++){let o=r[e].trim(),s=o.toLowerCase();if(n.some(e=>s.includes(e))&&s.length<50){a=!0;continue}if(s.includes("education")&&s.length<50&&a)break;if(a&&o.length>0){let e=o.match(/^(.+?)\s*[|\-–—]\s*(.+)$/);if(e){i&&t.push(i),i={position:e[1].trim(),company:e[2].trim(),startDate:"",endDate:"",current:!1,description:""};continue}let r=o.match(/(\d{4}|\w+\s+\d{4})\s*[-–—]\s*(Present|Current|\d{4}|\w+\s+\d{4})/i);if(r&&i){i.startDate=r[1];let e=r[2];"present"===e.toLowerCase()||"current"===e.toLowerCase()?i.current=!0:i.endDate=e;continue}i&&o.length>20&&(i.description+=(i.description?" ":"")+o)}}return i&&t.push(i),t.length>0?t:[]}(e),l=function(e){let t=[],r=e.split("\n"),n=!1;for(let a=0;a<r.length;a++){let i=r[a].trim(),o=i.toLowerCase();if(o.includes("education")&&o.length<50){n=!0;continue}if((o.includes("skills")||o.includes("technical"))&&o.length<50&&n)break;if(n&&i.length>0){let n=i.match(/(Bachelor|Master|PhD|Doctorate|Associate|Diploma|Certificate).*?(?:in|of)\s*(.+?)(?:,|\s+-\s+|\s*$)/i);if(n){let i=n[0].trim(),o=r[a+1]?.trim()||"",s=e.match(/(\d{4})/g),l=s?.[s.length-1]||"";t.push({degree:i,field:n[2]?.trim()||"",institution:o,graduationDate:l})}}}return t.length>0?t:[]}(e),c=function(e){let t={technical:"",soft:""},r=e.split("\n"),n=!1,a=["javascript","python","java","react","node","sql","aws","docker","git","typescript","html","css","mongodb","postgresql"];for(let e=0;e<r.length;e++){let i=r[e].trim(),o=i.toLowerCase();if((o.includes("skills")||o.includes("technical"))&&o.length<50){n=!0;continue}n&&i.length>0&&(a.some(e=>o.includes(e))?t.technical+=(t.technical?", ":"")+i:i.length>3&&(t.soft+=(t.soft?", ":"")+i))}return t}(e);return{personalInfo:i,professionalSummary:o||"",workExperience:s.length>0?s:[{company:"",position:"",startDate:"",endDate:"",current:!1,description:""}],education:l.length>0?l:[{institution:"",degree:"",field:"",graduationDate:""}],skills:{technical:c.technical||"",soft:c.soft||""}}}async function P(e){try{let t=await (0,E.auth)();if(!t?.userId)return R.NextResponse.json({error:"Unauthorized"},{status:401});let r=(await e.formData()).get("file");if(!r)return R.NextResponse.json({error:"No file provided"},{status:400});if("application/pdf"!==r.type)return R.NextResponse.json({error:"Only PDF files are supported"},{status:400});if(r.size>0xa00000)return R.NextResponse.json({error:"File size must be less than 10MB"},{status:400});let n=await r.arrayBuffer(),a=Buffer.from(n);if(!a||0===a.length)return R.NextResponse.json({error:"Invalid PDF file: file appears to be empty"},{status:400});let i=await v(a);return R.NextResponse.json(i)}catch(e){return console.error("Error parsing PDF:",e),e instanceof Error&&e.message,console.error("Full error:",e),R.NextResponse.json({error:"Failed to parse PDF. Please ensure it's a valid resume PDF.",details:void 0},{status:500})}}e.s(["POST",()=>P],10250);var A=e.i(10250);let b=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/resumes/parse-pdf/route",pathname:"/api/resumes/parse-pdf",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/src/app/api/resumes/parse-pdf/route.ts",nextConfigOutput:"",userland:A}),{workAsyncStorage:C,workUnitAsyncStorage:N,serverHooks:D}=b;function I(){return(0,n.patchFetch)({workAsyncStorage:C,workUnitAsyncStorage:N})}async function k(e,t,n){b.isDev&&(0,a.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let E="/api/resumes/parse-pdf/route";E=E.replace(/\/index$/,"")||"/";let R=await b.prepare(e,t,{srcPage:E,multiZoneDraftMode:!1});if(!R)return t.statusCode=400,t.end("Bad Request"),null==n.waitUntil||n.waitUntil.call(n,Promise.resolve()),null;let{buildId:x,params:v,nextConfig:y,parsedUrl:P,isDraftMode:A,prerenderManifest:C,routerServerContext:N,isOnDemandRevalidate:D,revalidateOnlyGenerated:I,resolvedPathname:k,clientReferenceManifest:O,serverActionsManifest:F}=R,T=(0,s.normalizeAppPath)(E),_=!!(C.dynamicRoutes[T]||C.routes[k]),S=async()=>((null==N?void 0:N.render404)?await N.render404(e,t,P,!1):t.end("This page could not be found"),null);if(_&&!A){let e=!!C.routes[k],t=C.dynamicRoutes[T];if(t&&!1===t.fallback&&!e){if(y.experimental.adapterPath)return await S();throw new g.NoFallbackError}}let M=null;!_||b.isDev||A||(M="/index"===(M=k)?"/":M);let j=!0===b.isDev||!_,U=_&&!j;F&&O&&(0,o.setManifestsSingleton)({page:E,clientReferenceManifest:O,serverActionsManifest:F});let q=e.method||"GET",Y=(0,i.getTracer)(),H=Y.getActiveScopeSpan(),L={params:v,prerenderManifest:C,renderOpts:{experimental:{authInterrupts:!!y.experimental.authInterrupts},cacheComponents:!!y.cacheComponents,supportsDynamicResponse:j,incrementalCache:(0,a.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:y.cacheLife,waitUntil:n.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,n,a)=>b.onRequestError(e,t,n,a,N)},sharedContext:{buildId:x}},z=new l.NodeNextRequest(e),K=new l.NodeNextResponse(t),$=c.NextRequestAdapter.fromNodeNextRequest(z,(0,c.signalFromNodeResponse)(t));try{let o=async e=>b.handle($,L).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=Y.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==u.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let n=r.get("next.route");if(n){let t=`${q} ${n}`;e.setAttributes({"next.route":n,"http.route":n,"next.span_name":t}),e.updateName(t)}else e.updateName(`${q} ${E}`)}),s=!!(0,a.getRequestMeta)(e,"minimalMode"),l=async a=>{var i,l;let c=async({previousCacheEntry:r})=>{try{if(!s&&D&&I&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let i=await o(a);e.fetchMetrics=L.renderOpts.fetchMetrics;let l=L.renderOpts.pendingWaitUntil;l&&n.waitUntil&&(n.waitUntil(l),l=void 0);let c=L.renderOpts.collectedTags;if(!_)return await (0,p.sendResponse)(z,K,i,L.renderOpts.pendingWaitUntil),null;{let e=await i.blob(),t=(0,h.toNodeOutgoingHttpHeaders)(i.headers);c&&(t[m.NEXT_CACHE_TAGS_HEADER]=c),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==L.renderOpts.collectedRevalidate&&!(L.renderOpts.collectedRevalidate>=m.INFINITE_CACHE)&&L.renderOpts.collectedRevalidate,n=void 0===L.renderOpts.collectedExpire||L.renderOpts.collectedExpire>=m.INFINITE_CACHE?void 0:L.renderOpts.collectedExpire;return{value:{kind:w.CachedRouteKind.APP_ROUTE,status:i.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:n}}}}catch(t){throw(null==r?void 0:r.isStale)&&await b.onRequestError(e,t,{routerKind:"App Router",routePath:E,routeType:"route",revalidateReason:(0,d.getRevalidateReason)({isStaticGeneration:U,isOnDemandRevalidate:D})},!1,N),t}},u=await b.handleResponse({req:e,nextConfig:y,cacheKey:M,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:C,isRoutePPREnabled:!1,isOnDemandRevalidate:D,revalidateOnlyGenerated:I,responseGenerator:c,waitUntil:n.waitUntil,isMinimalMode:s});if(!_)return null;if((null==u||null==(i=u.value)?void 0:i.kind)!==w.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==u||null==(l=u.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});s||t.setHeader("x-nextjs-cache",D?"REVALIDATED":u.isMiss?"MISS":u.isStale?"STALE":"HIT"),A&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let g=(0,h.fromNodeOutgoingHttpHeaders)(u.value.headers);return s&&_||g.delete(m.NEXT_CACHE_TAGS_HEADER),!u.cacheControl||t.getHeader("Cache-Control")||g.get("Cache-Control")||g.set("Cache-Control",(0,f.getCacheControlHeader)(u.cacheControl)),await (0,p.sendResponse)(z,K,new Response(u.value.body,{headers:g,status:u.value.status||200})),null};H?await l(H):await Y.withPropagatedContext(e.headers,()=>Y.trace(u.BaseServerSpan.handleRequest,{spanName:`${q} ${E}`,kind:i.SpanKind.SERVER,attributes:{"http.method":q,"http.target":e.url}},l))}catch(t){if(t instanceof g.NoFallbackError||await b.onRequestError(e,t,{routerKind:"App Router",routePath:T,routeType:"route",revalidateReason:(0,d.getRevalidateReason)({isStaticGeneration:U,isOnDemandRevalidate:D})},!1,N),_)throw t;return await (0,p.sendResponse)(z,K,new Response(null,{status:500})),null}}e.s(["handler",()=>k,"patchFetch",()=>I,"routeModule",()=>b,"serverHooks",()=>D,"workAsyncStorage",()=>C,"workUnitAsyncStorage",()=>N],92026)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__bed4ce78._.js.map
{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 60, "column": 0}, "map": {"version":3,"sources":["file:///Users/viveks/PycharmProjects/resume-builder/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client'\nimport { PrismaPg } from '@prisma/adapter-pg'\nimport { Pool } from 'pg'\n\nconst globalForPrisma = globalThis as unknown as {\n  prisma: PrismaClient | undefined\n}\n\nconst connectionString = process.env.DATABASE_URL\n\nif (!connectionString) {\n  throw new Error('DATABASE_URL environment variable is not set')\n}\n\nconst pool = new Pool({ connectionString })\nconst adapter = new PrismaPg(pool)\n\nexport const prisma =\n  globalForPrisma.prisma ??\n  new PrismaClient({\n    adapter,\n    log: process.env.NODE_ENV === 'development' ? ['error', 'warn'] : ['error'],\n  })\n\nif (process.env.NODE_ENV !== 'production') {\n  globalForPrisma.prisma = prisma\n}\n\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;;;;;;AAEA,MAAM,kBAAkB;AAIxB,MAAM,mBAAmB,QAAQ,GAAG,CAAC,YAAY;AAEjD,IAAI,CAAC,kBAAkB;IACrB,MAAM,IAAI,MAAM;AAClB;AAEA,MAAM,OAAO,IAAI,qJAAI,CAAC;IAAE;AAAiB;AACzC,MAAM,UAAU,IAAI,yKAAQ,CAAC;AAEtB,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,sMAAY,CAAC;IACf;IACA,KAAK,uCAAyC;QAAC;QAAS;KAAO,GAAG;AACpE;AAEF,wCAA2C;IACzC,gBAAgB,MAAM,GAAG;AAC3B"}},
    {"offset": {"line": 101, "column": 0}, "map": {"version":3,"sources":["file:///Users/viveks/PycharmProjects/resume-builder/src/app/api/resumes/%5Bid%5D/route.ts"],"sourcesContent":["import { auth, currentUser } from \"@clerk/nextjs/server\"\nimport { NextResponse } from \"next/server\"\nimport { prisma } from \"@/lib/prisma\"\n\n// GET a single resume\nexport async function GET(\n  request: Request,\n  { params }: { params: Promise<{ id: string }> }\n) {\n  try {\n    const { id } = await params\n    const authResult = await auth()\n    const userId = authResult?.userId\n    \n    if (!userId) {\n      return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 })\n    }\n\n    const dbUser = await prisma.user.findUnique({\n      where: { clerkId: userId },\n    })\n\n    if (!dbUser) {\n      return NextResponse.json({ error: \"User not found\" }, { status: 404 })\n    }\n\n    const resume = await prisma.resume.findFirst({\n      where: {\n        id,\n        userId: dbUser.id,\n      },\n    })\n\n    if (!resume) {\n      return NextResponse.json({ error: \"Resume not found\" }, { status: 404 })\n    }\n\n    return NextResponse.json({\n      ...resume,\n      personalInfo: JSON.parse(resume.personalInfo),\n      workExperience: JSON.parse(resume.workExperience),\n      education: JSON.parse(resume.education),\n      skills: JSON.parse(resume.skills),\n    })\n  } catch (error) {\n    console.error(\"Error fetching resume:\", error)\n    return NextResponse.json(\n      { error: \"Failed to fetch resume\" },\n      { status: 500 }\n    )\n  }\n}\n\n// PUT update a resume\nexport async function PUT(\n  request: Request,\n  { params }: { params: Promise<{ id: string }> }\n) {\n  try {\n    const { id } = await params\n    const authResult = await auth()\n    const userId = authResult?.userId\n    \n    if (!userId) {\n      return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 })\n    }\n\n    const dbUser = await prisma.user.findUnique({\n      where: { clerkId: userId },\n    })\n\n    if (!dbUser) {\n      return NextResponse.json({ error: \"User not found\" }, { status: 404 })\n    }\n\n    const body = await request.json()\n    const {\n      title,\n      layout,\n      isDraft,\n      personalInfo,\n      professionalSummary,\n      workExperience,\n      education,\n      skills,\n    } = body\n\n    // First verify the resume belongs to the user\n    const existingResume = await prisma.resume.findFirst({\n      where: {\n        id,\n        userId: dbUser.id,\n      },\n    })\n\n    if (!existingResume) {\n      return NextResponse.json({ error: \"Resume not found\" }, { status: 404 })\n    }\n\n    // Update the resume\n    const updateData: {\n      title: string\n      layout: string\n      isDraft: boolean\n      personalInfo: string\n      professionalSummary: string\n      workExperience: string\n      education: string\n      skills: string\n    } = {\n      title: title || \"Untitled Resume\",\n      layout: layout || \"layout1\",\n      isDraft: isDraft !== undefined ? isDraft : true,\n      personalInfo: JSON.stringify(personalInfo),\n      professionalSummary: professionalSummary || \"\",\n      workExperience: JSON.stringify(workExperience),\n      education: JSON.stringify(education),\n      skills: JSON.stringify(skills),\n    }\n\n    const updatedResume = await prisma.resume.update({\n      where: { id },\n      data: updateData,\n    })\n\n    return NextResponse.json({\n      ...updatedResume,\n      personalInfo: JSON.parse(updatedResume!.personalInfo),\n      workExperience: JSON.parse(updatedResume!.workExperience),\n      education: JSON.parse(updatedResume!.education),\n      skills: JSON.parse(updatedResume!.skills),\n    })\n  } catch (error) {\n    console.error(\"Error updating resume:\", error)\n    return NextResponse.json(\n      { error: \"Failed to update resume\" },\n      { status: 500 }\n    )\n  }\n}\n\n// DELETE a resume\nexport async function DELETE(\n  request: Request,\n  { params }: { params: Promise<{ id: string }> }\n) {\n  try {\n    const { id } = await params\n    const authResult = await auth()\n    const userId = authResult?.userId\n    \n    if (!userId) {\n      return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 })\n    }\n\n    const dbUser = await prisma.user.findUnique({\n      where: { clerkId: userId },\n    })\n\n    if (!dbUser) {\n      return NextResponse.json({ error: \"User not found\" }, { status: 404 })\n    }\n\n    const resume = await prisma.resume.deleteMany({\n      where: {\n        id,\n        userId: dbUser.id,\n      },\n    })\n\n    if (resume.count === 0) {\n      return NextResponse.json({ error: \"Resume not found\" }, { status: 404 })\n    }\n\n    return NextResponse.json({ success: true })\n  } catch (error) {\n    console.error(\"Error deleting resume:\", error)\n    return NextResponse.json(\n      { error: \"Failed to delete resume\" },\n      { status: 500 }\n    )\n  }\n}\n\n"],"names":[],"mappings":"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"}}]
}